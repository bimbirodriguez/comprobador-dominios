<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Comprobador de dominios</title>
<style>
  body{font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial; padding:20px; background:#f8fafc; color:#0f172a}
  .card{max-width:900px;margin:0 auto;background:white;border-radius:10px;padding:18px;box-shadow:0 6px 18px rgba(15,23,42,0.06)}
  h1{margin:0 0 8px;font-size:20px}
  p{margin:0 0 14px;color:#475569}
  button{background:#0ea5a4;color:white;border:0;padding:10px 14px;border-radius:8px;cursor:pointer}
  button[disabled]{opacity:.6;cursor:default}
  table{width:100%;border-collapse:collapse;margin-top:12px}
  th,td{padding:8px;border-bottom:1px solid #eef2f7;text-align:left;font-size:14px}
  th{background:#f1f5f9}
  .ok{color:green;font-weight:700}
  .blocked{color:#dc2626;font-weight:700}
  .warn{color:#b45309;font-weight:700}
  small{color:#94a3b8}
</style>
</head>
<body>
  <div class="card">
    <h1>Comprobador de dominios</h1>
    <p>Pulsa <strong>Comprobar</strong> y tu navegador probará, desde tu conexión, qué dominios están accesibles.</p>

    <p><small>Edita <code>const domains</code> en este archivo para cambiar la lista de dominios.</small></p>

    <button id="checkBtn">Comprobar</button>
    <table aria-live="polite">
      <thead>
        <tr><th>#</th><th>Dominio</th><th>Resultado</th></tr>
      </thead>
      <tbody id="results"></tbody>
    </table>
  </div>

<script>
/*
  Lista de dominios a probar: cámbiala por tus dominios.
  Asegúrate de incluir el esquema: "https://" o "http://".
*/
const domains = [
  "https://4ksmart.me/",
  "https://cf.cdn-959.me/"
];

const TIMEOUT_MS = 7000; // tiempo máximo por petición

function testDomain(url) {
  return new Promise((resolve) => {
    const controller = new AbortController();
    const timer = setTimeout(()=> {
      controller.abort();
    }, TIMEOUT_MS);

    // mode:"no-cors" -> si responde, fetch resuelve aunque la respuesta sea "opaca".
    fetch(url, {method: "GET", mode: "no-cors", cache: "no-store", signal: controller.signal})
      .then(() => {
        clearTimeout(timer);
        // Si fetch resolvió, consideramos el dominio accesible desde la conexión del cliente.
        resolve({url, ok: true});
      })
      .catch((err) => {
        clearTimeout(timer);
        // Si hubo error (abort, DNS, network), consideramos bloqueado/no responde.
        resolve({url, ok: false, error: err && err.name ? err.name : String(err)});
      });
  });
}

async function runChecks() {
  const btn = document.getElementById('checkBtn');
  const tbody = document.getElementById('results');
  tbody.innerHTML = '';
  btn.disabled = true;
  btn.textContent = 'Comprobando...';

  // Lanzamos todas las comprobaciones en paralelo
  const checks = domains.map(d => testDomain(d));
  const results = await Promise.all(checks);

  // Mostrar resultados (manteniendo orden original)
  results.forEach((r, i) => {
    const tr = document.createElement('tr');
    if (r.ok) {
      tr.innerHTML = `<td>${i+1}</td><td>${r.url}</td><td class="ok">Disponible</td>`;
    } else {
      tr.innerHTML = `<td>${i+1}</td><td>${r.url}</td><td class="blocked">Bloqueado o no responde <small>(${r.error||'timeout'})</small></td>`;
    }
    tbody.appendChild(tr);
  });

  btn.disabled = false;
  btn.textContent = 'Comprobar';
}

document.getElementById('checkBtn').addEventListener('click', runChecks);
</script>
</body>
</html>
